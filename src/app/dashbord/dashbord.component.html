<app-navbar></app-navbar>
<div class="container">
    <h2><i class="pi pi-chart-bar"></i> รายงานกระแสเงินสดไร่มันสำปะหลัง</h2>

    <!-- ✅ เมนูเลือกปี -->
    <div class="filter-section">
        <label for="yearSelect">เลือกปี:</label>
        <select id="yearSelect" [(ngModel)]="selectedYear" (change)="loadCashFlowReport()">
            <option *ngFor="let year of availableYears" [value]="year">{{ year }}</option>
        </select>
    </div>

    <div class="summary">
        <div class="summary-item">
            <i class="pi pi-sitemap"></i>
            <p>จำนวนแปลง</p>
            <strong>{{ summary.plotCount || 0 }} แปลง</strong>
        </div>
        <div class="summary-item">
            <i class="pi pi-map"></i>
            <p>พื้นที่ทั้งหมด</p>
            <strong>{{ summary.totalArea || 0 }} ไร่</strong>
        </div>
        <div class="summary-item">
            <i class="pi pi-chart-bar"></i>
            <p>ผลผลิตรวม</p>
            <strong>{{ summary.totalHarvest || 0 }} กิโลกรัม</strong>
        </div>
    </div>
    <!-- ✅ รายรับ-รายจ่ายรวม -->
    <h3>รายรับ-รายจ่ายรวม</h3>
    <div class="income-expense">
        <div class="income">
            <i class="pi pi-dollar"></i>
            <p>รายรับ</p>
            <strong>{{ incomeExpense.totalIncome | number }} บาท</strong>
        </div>
        <div class="expense">
            <i class="pi pi-wallet"></i>
            <p>รายจ่าย</p>
            <strong>{{ incomeExpense.totalExpense | number }} บาท</strong>
        </div>
        <div class="net-income">
            <i class="pi pi-money-bill"></i>
            <p>กำไร/ขาดทุน</p>
            <strong [ngClass]="{'profit': incomeExpense.netIncome >= 0, 'loss': incomeExpense.netIncome < 0}">
                {{ incomeExpense.netIncome | number }} บาท
            </strong>
        </div>
    </div>



 <!-- ✅ กล่องแสดงกราฟที่ใหญ่ขึ้น -->
<div class="chart-container">
    <h3>
        <i class="pi pi-chart-bar"></i> รายรับ-รายจ่ายรายเดือน
    </h3>
    <p-chart type="bar" [data]="chartData" [options]="chartOptions"></p-chart>
</div>

</div>